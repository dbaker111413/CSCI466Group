<?php
/*
  Owners: Daniel Baker, Jackie Salim, Tanner Martin, & Kevin Tee
  CSCI 466
  Spring 2018

  Group Project # 8
  Purpose of file: Contain object data for an appointment

*/

  require_once("globalFunctions.php");

  class Appointment {
    public $AID = 0;
    public apptDate = "";
    public apptTime = "";

    private $conn;

    // constructor takes a PDOConnection object
    function __construct($conn){
      $this->conn = $conn;
    }

    // uses the first and last name to get the entire therapist column data.
    // expects the name to be in "LastName, FirstName" format
    public function setAppointment($aid){

      // create a sql select statement to query the data
      $selectSQL = "select * from Appointment where AID = '".$AID."'";

      // now wrap the query in a try catch block
      try{
        $dataArray = $this->conn->query($selectSQL);
        // make sure there is only one row in the array
        if(count($dataArray) != 1){
          showAlert("An invalid number of rows were returned, bad query!");
        }
        else{
          foreach ($dataArray as $data){
            $this->AID = $data['TID'];
            $this->tFirstName = $data['tFirstName'];
            $this->tLastName = $data['tLastName'];
            $this->numPatients = $data['numPatients'];
            $this->phone = $data['phone'];
          }
        }
      }
      catch (PDOException $e){
        showAlert($e->getMessage());
      }
      catch(Exception $e){
        showAlert($e->getMessage());
      }
    }
  }
?>

